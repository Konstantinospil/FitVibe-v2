# FitVibe â€“ Testing & Quality Assurance Plan (v2.0)

**Product:** FitVibe â€“ Training Planner & Logger Web App  
**Author:** Konstantinos Pilpilidis  
**Revision:** v2.0  
**Date:** 2025-10-05  
**Scope:** Unified QA baseline for MVP (Frontend, Backend, Infrastructure)  
**Cross-Reference:** PRD Â§4-6-11 / TDD Â§4-11

---

## Table of Contents

1. Purpose & Scope
2. QA Objectives
3. Acceptance Criteria (FR & NFR)
4. Requirements Traceability Matrix (RTM)
5. Test Levels & Responsibilities
6. Test Strategy (per Layer)
7. Test Environments & Data
8. Quality Metrics & Thresholds
9. Toolchain & Automation
10. Accessibility & Usability Testing
11. Performance & Load Testing
12. Security & Compliance Testing
13. CI/CD Integration & Reporting
14. Defect Management Workflow
15. Continuous Improvement Process
16. Glossary

---

## 1 Purpose & Scope

This plan defines the quality-assurance framework for the **FitVibe MVP**.  
It unifies all test and validation activities across **frontend**, **backend**, and **infrastructure**, ensuring that:

- Functional Requirements (FR-1 â€¦ FR-8) in the PRD are implemented and verified.
- Non-Functional Requirements (NFR Â§5) are measurable and continuously monitored.
- All QA stages integrate seamlessly into CI/CD pipelines.

---

## 2 QA Governance

| Role             | Responsibility                                        |
| ---------------- | ----------------------------------------------------- |
| QA Lead          | Approves test plans, monitors coverage, reports to PO |
| Product Owner    | Defines acceptance criteria, signs off on UAT         |
| Dev Lead         | Ensures CI/CD QA integration and release gates        |
| Security Officer | Oversees vulnerability management                     |
| QA Reviewer      | Performs quarterly audit of QA artifacts              |

**Review cadence:** QA Plan reviewed each release or quarterly, whichever earlier.

---

## 3 QA Objectives

| Goal                   | Target                                                     |
| ---------------------- | ---------------------------------------------------------- |
| Functional correctness | 100 % pass rate on register â†’ login â†’ plan â†’ complete flow |
| Test coverage          | â‰¥ 80 % lines + branches per module                         |
| Regression runtime     | < 15 min for CI pipeline                                   |
| Frontend LCP           | < 2.5 s on mid-tier 4 G device                             |
| API latency (p95)      | < 300 ms                                                   |
| Accessibility          | WCAG 2.1 AA conformance                                    |
| Availability           | â‰¥ 99.5 % SLO                                               |
| Security               | 0 critical CVEs / build                                    |
| GDPR & privacy         | 100 % compliance verified quarterly                        |

---

## 4 QA Out-of-Scope (MVP)

| Area                    | Reason for Exclusion   | Planned Phase |
| ----------------------- | ---------------------- | ------------- |
| Real-time collaboration | Deferred to Phase 2    | 2             |
| Nutrition tracking      | Not implemented in MVP | 3             |
| Wearables integration   | Hardware dependency    | 3             |
| Notification engine     | Cost optimization      | 2             |

---

## 5 Acceptance Criteria (Functional & Non-Functional)

### 5.1 Functional Acceptance Criteria

### 5.1 Functional Acceptance Criteria (with Test IDs)

| ID          | Requirement (PRD Â§4)             | Acceptance Criterion                                                                                                                                                          | Verification Method                                                 |
| ----------- | -------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------- |
| **AC-1.1**  | FR-1 User Mgmt & Security        | User must verify email before login (**15 min TTL; resend â‰¤ 3/hour; unverified purged in 7 days**)                                                                            | Unit + Integration                                                  |
| **AC-1.2**  | FR-1 User Mgmt & Security        | System locks account after 10 failed login attempts and requires CAPTCHA                                                                                                      | Integration (Supertest)                                             |
| **AC-1.3**  | FR-1 User Mgmt & Security        | Password policy enforced: â‰¥ 12 chars, includes upper/lower/number/symbol                                                                                                      | Unit + Integration                                                  |
| **AC-1.4**  | FR-1 User Mgmt & Security        | GDPR export and delete requests processed â‰¤ 30 days                                                                                                                           | E2E + Manual audit                                                  |
| **AC-1.5**  | FR-1 User Mgmt & Security        | 2FA (TOTP) enrollment requires current password; generates 10 single-use backup codes                                                                                         | Integration + E2E                                                   |
| **AC-1.6**  | FR-1 User Mgmt & Security        | If 2FA enabled, login requires valid TOTP or one-time backup code (burn after use)                                                                                            | E2E                                                                 |
| **AC-1.7**  | FR-1 User Mgmt & Security        | Admin endpoints enforce `role=admin`; non-admin receives 403; no IDOR                                                                                                         | Integration + Security                                              |
| **AC-1.8**  | FR-1 User Mgmt & Security        | Email verify resend limited to 3/hour; unverified accounts auto-purged at 7 days                                                                                              | Integration (rate-limit harness) + Scheduled job test               |
| **AC-1.9**  | FR-1 User Mgmt & Security        | Reset token single-use, TTL 15 min; successful reset revokes all refresh sessions                                                                                             | Integration + Security (negative reuse)                             |
| **AC-1.10** | FR-1 User Mgmt & Security        | Refresh rotation & revocation: â€œRefresh token rotates on every use; old jti is revoked; logout clears active sessions; verified via DB (refresh_tokens) and 401 on old token. | Verification: Integration + Security                                |
| **AC-1.11** | FR-1 User Mgmt & Security        | JWKS & key rotation: â€œJWKS endpoint serves current+previous keys; signing key rotation alarmed annually; tokens validate against both during grace.                           | Verification: Integration (JWKS fetch/validate) + Operability check |
| **AC-1.12** | FR-1 User Mgmt & Security        | No user enumeration: â€œAuth endpoints return generic responses for non-existent users; timing variance â‰¤ 10% vs valid user.                                                    | Verification: Security (negative tests + timing budget).            |
| **AC-2.1**  | FR-2 Profile & Settings          | Alias must be unique (case-insensitive)                                                                                                                                       | Integration                                                         |
| **AC-2.2**  | FR-2 Profile & Settings          | Avatar â‰¤ 5 MB (JPEG/PNG/WebP) renders correctly in UI                                                                                                                         | E2E (Playwright)                                                    |
| **AC-2.3**  | FR-2 Profile & Settings          | Each update creates a snapshot in `user_state_history`                                                                                                                        | Integration                                                         |
| **AC-2.4**  | FR-2 Profile & Settings          | `dateOfBirth` and `gender` are immutable post-creation (attempts return 422)                                                                                                  | Integration + Contract                                              |
| **AC-2.5**  | FR-2 Profile & Settings          | File uploads are AV-scanned; EICAR blocked with 400 and audit entry                                                                                                           | Security + Integration                                              |
| **AC-3.1**  | FR-3 Exercise Library            | Delete operation archives record (soft-delete)                                                                                                                                | Integration                                                         |
| **AC-3.2**  | FR-3 Exercise Library            | Public visibility flag controls discovery in feed                                                                                                                             | Integration + E2E                                                   |
| **AC-3.3**  | FR-3 Exercise Library            | Exercise name snapshot retained in `session_exercises`                                                                                                                        | DB test                                                             |
| **AC-3.4**  | FR-3 Exercise Library            | Global library RBAC: â€œOnly admins can create/update/delete global exercises; members can create personal ones only; all actions audited.                                      | Verification: Integration + Security (ZAP auth context)             |
| **AC-4.1**  | FR-4 Sessions                    | System stores time-zone-safe timestamps (DST verified)                                                                                                                        | Unit + Integration                                                  |
| **AC-4.2**  | FR-4 Sessions                    | Planned vs Actual comparison visible in session view                                                                                                                          | E2E                                                                 |
| **AC-4.3**  | FR-4 Sessions                    | Cloned session preserves attribution to original                                                                                                                              | E2E                                                                 |
| **AC-4.4**  | FR-4 Sessions                    | RRULE instance expansion is DST-safe across timezone transitions                                                                                                              | Unit + Integration                                                  |
| **AC-4.5**  | FR-4 Sessions                    | Cancelled session instances persist and are excluded from streaks/points                                                                                                      | Integration + E2E                                                   |
| **AC-4.6**  | FR-4 Sessions                    | Switching publicâ†’private removes past items from feed/search within 5 min                                                                                                     | E2E + Security                                                      |
| **AC-5.1**  | FR-5 Progress & Analytics        | Aggregations by date & category return accurate totals                                                                                                                        | Unit                                                                |
| **AC-5.2**  | FR-5 Progress & Analytics        | Personal bests (PBs) & streaks calculated correctly                                                                                                                           | Integration                                                         |
| **AC-5.3**  | FR-5 Progress & Analytics        | Export endpoints deliver valid CSV / JSON                                                                                                                                     | E2E                                                                 |
| **AC-6.1**  | FR-6 Points System               | Points awarded automatically on `session.complete()`                                                                                                                          | Integration                                                         |
| **AC-6.2**  | FR-6 Points System               | Scoring formula produces only non-negative bounded values                                                                                                                     | Unit                                                                |
| **AC-6.3**  | FR-6 Points System               | Anti-gaming checks logged when thresholds exceeded                                                                                                                            | Perf (k6) + Security                                                |
| **AC-6.4**  | FR-6 Points System               | API/UI never expose scoring formula or raw factors; only final points visible                                                                                                 | Contract + E2E                                                      |
| **AC-6.5**  | FR-6 Points System               | Admin point adjustments create immutable audit entry (actor, reason, ts, diff)                                                                                                | Integration + Security                                              |
| **AC-7.1**  | FR-7 Sharing & Community         | Default privacy = private for all sessions                                                                                                                                    | Unit + Integration                                                  |
| **AC-7.2**  | FR-7 Sharing & Community         | Public feed is paginated + searchable                                                                                                                                         | Integration                                                         |
| **AC-7.3**  | FR-7 Sharing & Community         | Cloned session includes attribution metadata                                                                                                                                  | E2E                                                                 |
| **AC-8.1**  | FR-8 Internationalization (i18n) | Language auto-detected from browser / profile                                                                                                                                 | Unit                                                                |
| **AC-8.2**  | FR-8 Internationalization (i18n) | Manual language switch persists between sessions                                                                                                                              | E2E                                                                 |
| **AC-8.3**  | FR-8 Internationalization (i18n) | All UI strings come from **static token catalogs** (EN/DE); **no runtime translation**                                                                                        | Unit + Integration                                                  |
| **AC-8.4**  | FR-8 Internationalization (i18n) | No **untranslated keys**; **fallback = EN** for missing tokens; lint prevents stray literals                                                                                  | Static + Unit                                                       |
| **AC-8.5**  | FR-8 i18n                        | DSR delete removes related entries from translation_cache and any external caches                                                                                             | Integration + Operability (restore validation)                      |

### 5.2 Non-Functional Acceptance Criteria (PRD Â§5)

| Category                 | Metric                            | Target                                                                                   | Verification                                      |
| ------------------------ | --------------------------------- | ---------------------------------------------------------------------------------------- | ------------------------------------------------- |
| **Security**             | Auth / 2FA / CORS / CSRF          | All middleware active per TDD Â§10                                                        | Automated security tests                          |
| **Security**             | Security headers                  | CSP disallows `unsafe-inline`; cookies `HttpOnly; Secure; SameSite=Lax`                  | ZAP/Lighthouse assertions                         |
| **Security**             | Transport security                | TLS 1.3 negotiated; OCSP stapling enabled                                                | SSL scan (sslyze/observatory)                     |
| **Performance**          | API p95 latency                   | < 300 ms                                                                                 | k6 CI run                                         |
| **Performance**          | Per-endpoint budgets              | Auth p95 â‰¤ 200 ms; CRUD p95 â‰¤ 300 ms; Feed p95 â‰¤ 400 ms; Analytics p95 â‰¤ 600 ms          | k6 grouped smoke in CI                            |
| **Performance**          | Regression guard                  | Block on >10% latency regression vs baseline                                             | CI gate                                           |
| **Performance**          | API calls per page                | â‰¤ 5 on first paint for key routes                                                        | Lighthouse budget + Playwright network assertions |
| **Availability**         | Uptime (SLO)                      | â‰¥ 99.5 % monthly                                                                         | Prometheus alert                                  |
| **Accessibility**        | WCAG 2.1 AA                       | â‰¥ 90 % axe score                                                                         | Lighthouse CI                                     |
| **Privacy & GDPR**       | DSR response time                 | â‰¤ 30 days                                                                                | Manual audit                                      |
| **Privacy & GDPR**       | Consent gating                    | No non-essential analytics before opt-in; events include `consent=true` after            | E2E network assertions                            |
| **Privacy & GDPR**       | Delete propagation                | Confirm DSR deletes propagate to backups â‰¤14 days with quarterly restore drill evidence  | DR drill + audit log                              |
| **Backup / DR**          | RPO â‰¤ 24 h RTO â‰¤ 4 h              | Quarterly restore test + regional failover simulation                                    |
| **Observability**        | Logs & Metrics                    | 100 % routes instrumented                                                                | Prometheus & Grafana                              |
| **Observability**        | Metrics contract                  | `/metrics` exposes required histograms/counters with `{method,route,status_code}` labels | Metrics scrape test                               |
| **Observability**        | RUM & DB metrics                  | `frontend_lcp_ms` (RUM gauge) and `db_query_duration_ms` (histogram) exposed and scraped | Metrics scrape test                               |
| **Database performance** | Slow-query alerting               | Alert on queries >200 ms (pg_stat_statements)                                            | Prometheus rule + test scrape                     |
| **Release Safety**       | Feature flags default-off in prod | rollback smoke passes                                                                    | CI check + canary smoke.                          |

---

## 6 Requirements Traceability Matrix (RTM)

| PRD Ref                                | Acceptance Criteria IDs                                                                  | TDD Section                        | Test Case / Path                                                                                          | Verification Type                             |
| :------------------------------------- | :--------------------------------------------------------------------------------------- | :--------------------------------- | :-------------------------------------------------------------------------------------------------------- | :-------------------------------------------- |
| **FR-1 User Mgmt & Security**          | AC-1.1 â†’ AC-1.12                                                                         | Â§ 4.2 Auth / Â§ 5 F2 + F3           | `/tests/api/auth.test.ts`, `/tests/e2e/auth.spec.ts`, `/tests/security/auth_zap_scan.yaml`                | Unit + Integration + E2E + Security           |
| **FR-2 Profile & Settings**            | AC-2.1 â†’ AC-2.5                                                                          | Â§ 4.3 Users                        | `/tests/api/users.test.ts`, `/tests/e2e/profile.spec.ts`                                                  | Integration + E2E                             |
| **FR-3 Exercise Library**              | AC-3.1 â†’ AC-3.4                                                                          | Â§ 4.4 Exercises                    | `/tests/api/exercises.test.ts`, `/tests/db/exercises_schema.test.ts`, `/tests/security/zap_auth.ctx.yaml` | Integration + DB Schema + Security            |
| **FR-4 Sessions (Plan / Log / Clone)** | AC-4.1 â†’ AC-4.6                                                                          | Â§ 4.5 Sessions + F4 F5 F6          | `/tests/api/sessions.test.ts`, `/tests/e2e/session.spec.ts`, `/tests/perf/session_load.k6.js`             | Integration + E2E + Performance               |
| **FR-5 Progress & Analytics**          | AC-5.1 â†’ AC-5.3                                                                          | Â§ 4.6 Progress                     | `/tests/api/progress.test.ts`, `/tests/frontend/dashboard.spec.ts`                                        | Unit + Integration + UI                       |
| **FR-6 Points System**                 | AC-6.1 â†’ AC-6.5                                                                          | Â§ 4.7 Points + F5                  | `/tests/api/points.test.ts`, `/tests/perf/points_stress.k6.js`                                            | Integration + Performance + Security          |
| **FR-7 Sharing & Community**           | AC-7.1 â†’ AC-7.3                                                                          | Â§ 4.8 Feed + F6                    | `/tests/api/feed.test.ts`, `/tests/e2e/feed.spec.ts`                                                      | Integration + E2E                             |
| **FR-8 Internationalization (i18n)**   | AC-8.1 â†’ AC-8.5                                                                          | Â§ 4.10 i18n / Localization         | `/tests/api/i18n.test.ts`, `/tests/frontend/i18n.spec.tsx`, `/tests/security/pii_sanitization.test.ts`    | Unit + Integration + Accessibility + Security |
| **NFR 5.1 Security Middleware**        | AC-1.2, AC-1.7, AC-8.4                                                                   | Â§ 10 Security                      | `/tests/security/*.test.ts`                                                                               | Static + Dynamic                              |
| **NFR 5.2 Privacy & GDPR**             | Consent gating                                                                           | Â§ 10 Privacy                       | `/tests/e2e/consent.spec.ts`                                                                              | E2E                                           |
| **NFR 5.3 Privacy & GDPR**             | **Backups retain PII â‰¤14 days**; restore drill **replays `erasure_ledger` successfully** | Â§ 15 Security & Compliance         | `/tests/compliance/backup_purge.test.ts`, `/tests/dr/restore_erasure_replay.test.ts`                      | Compliance + DR                               |
| **NFR 5.4 Performance**                | Per-endpoint budgets & regression guard                                                  | Â§ 11.3 Performance Testing         | `/tests/perf/k6/*.js`                                                                                     | Load Testing                                  |
| **NFR 5.5 Accessibility**              | AC-8.1 â†’ AC-8.2                                                                          | QA Â§ 13 Accessibility              | `/tests/accessibility/*.spec.ts`                                                                          | axe-core + Lighthouse                         |
| **NFR 5.6 Observability**              | Metrics contract                                                                         | Â§ 13.1 â€“ 13.3 Monitoring & Metrics | `/tests/metrics/prometheus_exposure.test.ts`                                                              | Monitoring Validation                         |
| **NFR 5.7 Backup & DR**                | â€“                                                                                        | Â§ 13 Operability / DR Policy       | manual restore procedure logs                                                                             | Operational Test (Audit)                      |

---

## 7 Test Levels & Responsibilities

| Level             | Owner            | Purpose                              |
| ----------------- | ---------------- | ------------------------------------ |
| **Unit**          | Developers       | Validate single functions / services |
| **Integration**   | Backend team     | Validate API â†” DB interaction       |
| **Contract**      | Full-stack devs  | DTO â‡„ OpenAPI alignment              |
| **E2E**           | QA + FE dev      | Simulate user journeys               |
| **Security**      | DevOps + Auditor | Static & dynamic scans               |
| **Performance**   | DevOps           | Load / stress tests (k6)             |
| **Accessibility** | UX Team          | axe + Lighthouse CI                  |
| **UAT**           | Product Owner    | Sign-off vs acceptance criteria      |

---

## 8 Test Strategy (per Layer)

### 8.1 Backend (API)

- Framework: Jest + Supertest
- Isolation: Ephemeral PostgreSQL in Docker
- Mocks: Mailer, time provider, UUIDs
- Coverage: â‰¥ 80 % lines & branches

### 8.2 Frontend (SPA)

- Framework: Vitest / Jest + React Testing Library
- Mock API layer (Axios Mock Adapter)
- Snapshot tests for Planner, Logger, Progress Chart

### 8.3 Contract Tests

- zod â‡„ OpenAPI validation pipeline (`ts-to-openapi`)
- Run on every build to detect schema drift
- Negative schema assertions: scoring endpoints must not expose formula/internal factors.
- DB contract checks: required indexes exist (GIN on exercises.tags, sessions(owner_id, planned_at DESC), plans(user_id, status)); migrations up-to-date (no drift).

### 8.4 End-to-End (E2E)

- Tool: Playwright (Chromium + WebKit + Firefox)
- Flows: Register â†’ Login â†’ Plan â†’ Complete â†’ View Progress
- Auth helper for cookie-based login

---

## 9 Test Environments & Data

| Env            | Purpose            | DB Source                    | Access         |
| -------------- | ------------------ | ---------------------------- | -------------- |
| **Local**      | Developer testing  | Local Postgres + seeded data | localhost      |
| **CI**         | Automated pipeline | Ephemeral Docker PG          | GitHub Actions |
| **Staging**    | Pre-release / UAT  | Snapshot of prod schema      | restricted     |
| **Production** | Monitoring / Smoke | Live readonly / health       | limited        |

Data protection: test accounts use non-PII seed records (`seed-dev.ts`).

### QA Test Data Management

- Synthetic, non-PII data only
- Ephemeral databases destroyed post-run
- Access restricted to CI service accounts
- No production data replicated

### 10 QA Trend Visualization

- Grafana dashboards:
  - **Coverage Trend** (backend/frontend)
  - **Flaky Test Index** (tests failing â‰¥2x/quarter)
  - **Defect Density per 1 KLOC**
- QA reports auto-published to `/reports/qa_summary.html`.

---

## 11 Quality Metrics & Thresholds

| Metric                    | Target                                                     | Measured By                                       |
| ------------------------- | ---------------------------------------------------------- | ------------------------------------------------- |
| Unit coverage             | â‰¥ 80 %                                                     | Jest report                                       |
| Integration pass rate     | 100 %                                                      | CI summary                                        |
| E2E flows                 | 100 %                                                      | Playwright dashboard                              |
| Accessibility score       | â‰¥ 90 %                                                     | axe-core / Lighthouse                             |
| Perf p95                  | < 300 ms                                                   | k6 metrics                                        |
| LCP (frontend)            | < 2.5 s                                                    | Lighthouse CI                                     |
| Error budget (SLO 99.5 %) | < 0.5 % downtime                                           | Prometheus alerts                                 |
| Endpoint group p95        | authâ‰¤200 ms Â· crudâ‰¤300 ms Â· feedâ‰¤400 ms Â· analyticsâ‰¤600 ms | k6 grouped smoke (CI)                             |
| Perf regression guard     | Block merges if >10% over baseline                         | CI gate                                           |
| API calls/page            | â‰¤ 5                                                        | Lighthouse budget + Playwright network assertions |
| DB schema drift           | 0 missing required indexes/migrations                      | Migration check + psql assertion                  |
| RUM LCP p75               | â‰¤ 2500 ms on mid-tier device                               | RUM aggregator / Prometheus                       |
| DB query p95              | â‰¤ 600 ms (key dashboards)                                  | `db_query_duration_ms` histogram                  |

---

## 12 Toolchain & Automation

| Area          | Tool                         | Notes                              |
| ------------- | ---------------------------- | ---------------------------------- |
| Testing       | Jest / Vitest                | Unified config `jest.config.ts`    |
| E2E           | Playwright                   | Headless runs in CI                |
| Accessibility | axe-core / Lighthouse CI     | Auto audit pipeline                |
| Load          | k6                           | `/tests/load/*.js` scenarios       |
| Security      | npm-audit / Snyk / OWASP ZAP | Weekly scans                       |
| Coverage      | Codecov / GH Summary         | PR comments + threshold gate       |
| CI            | GitHub Actions               | Matrix: backend / frontend / tests |

---

## 13 Accessibility & Usability Testing

- Automated: Lighthouse CI + axe-core
  - Ensure consent banner blocks non-essential analytics until opt-in (Playwright network assertions).
- Manual: keyboard nav + JAWS/NVDA
- Contrast: WCAG AA â‰¥ 4.5 : 1 validated via Figma/DevTools
- Usability: 10-user heuristic evaluation (post-MVP)

---

## 14 Performance & Load Testing

- Tool: k6 (TypeScript scenarios)
- Baseline: 100 req/s, error < 0.1 %
- Metrics: p95 < 300 ms, p99 < 600 ms
- Schedule: nightly (staging) + monthly trend review
- Output: Grafana dashboard (`http_request_duration_seconds`)
- Grouped CI smoke budgets per endpoint group (authâ‰¤200 ms, crudâ‰¤300 ms, feedâ‰¤400 ms, analyticsâ‰¤600 ms); fail job on breach.
- Regression guard: fail CI if p95 degrades >10% vs rolling baseline.
- Enforce response size â‰¤ 1 MB and gzip/Brotli for >1 KB payloads in integration tests.
- Fail CI if any key route triggers >5 API calls on first paint (cold cache).
- Seed â‰¥10k sessions; assert no dashboard queries exceed 200 ms median / 600 ms p95 in CI dataset.

---

## 15 Security & Compliance Testing

| Type                   | Method                                                                   | Frequency                            |
| ---------------------- | ------------------------------------------------------------------------ | ------------------------------------ |
| Static dependency scan | `npm audit --production`                                                 | each build                           |
| Dynamic scan           | OWASP ZAP baseline                                                       | weekly                               |
| Pen test               | External audit                                                           | pre-Phase 2 launch                   |
| GDPR review            | Checklist (DSR, retention)                                               | quarterly                            |
| Secrets detection      | GitHub Secret Scan                                                       | continuous                           |
| Dynamic scan           | OWASP ZAP (auth context, admin routes, feed privacy)                     | weekly                               |
| Upload AV test         | EICAR sample blocked (400 + audit log)                                   | each build                           |
| Headers policy         | Assert CSP no `unsafe-inline`; cookies `HttpOnly; Secure; SameSite=Lax`  | each build                           |
| Rate limiting          | Burst/steady-state thresholds enforced at app and edge; lockouts logged  | k6 abuse scenario + ZAP auth context |
| Rate limiting          | Auth/feed abuse scenarios trigger app+edge throttling; incidents audited | each build                           |
| Password reset         | Single-use token; revoke all sessions on success; negative reuse blocked | each build                           |
| Image scanning         | Trivy (or Grype) fails on HIGH/CRITICAL CVEs                             | each build                           |
| Headers policy (edge)  | Assert HSTS, Referrer-Policy, Permissions-Policy                         | each build                           |
| Supply chain           | SBOM generated & archived per release; fail if missing                   | each build                           |
| Artifact integrity     | Docker image **signed with Cosign**; CI verifies signature before deploy | each build                           |
| Immutable deploys      | **Pinned sha256 digests** enforced; fail if tag not a digest             | each deploy                          |
| TLS/OCSP audit         | Verify TLS1.3 ciphers & OCSP stapling on edge                            | weekly                               |
| DR drill (regional)    | Simulated region failover, runbooks validated, evidence archived         | quarterly                            |

---

## 16 CI/CD Integration & Reporting

1. Lint â†’ Type-Check â†’ Unit Tests
2. Integration Tests (ephemeral DB)
3. E2E Playwright (on push to main)
4. Coverage â†’ Codecov PR comment
5. Lighthouse audit â†’ fail < 90 score
6. Security scan â†’ fail on high CVE
7. Feature-flag defaults check â†’ assert prod config flags are false
8. Docker build â†’ push GHCR â†’ manual CD
9. Generate SBOM â†’ archive artifact
10. Cosign sign image â†’ verify signature
11. Enforce pinned digest (sha256) for deploy manifests
12. perf-k6-smoke â†’ grouped budgets; block on breach or >10% regression
13. zap-baseline (authenticated) â†’ admin-route RBAC, CSP/cookies, feed privacy
14. metrics-contract â†’ scrape `/metrics` and assert required labels/series
15. Deploy to staging (manual CD)
16. Release-safety / rollback-smoke gate â†’ must pass before prod
17. Approve â†’ deploy to prod

Reports: HTML coverage (`/coverage`), JUnit XML (CI artifact), Playwright trace, Accessibility reports (`/reports/accessibility/`).

```yaml
jobs:
  perf-k6-smoke:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: grafana/setup-k6@v1
      - run: k6 run ./tests/perf/smoke.js --out json=perf.json
      - run: node ./tests/perf/assert-budgets.mjs perf.json # exit non-zero on breach

  zap-baseline:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: zaproxy/action-baseline@v0.10.0
        with:
          target: ${{ secrets.APP_URL }}
          rules_file_name: .zap/rules.tsv
          cmd_options: -a -I

  metrics-contract:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: node tests/metrics/assert-prom.js # checks labels and required series
```

---

## 17 Defect Management Workflow

| Step         | Description                           |
| ------------ | ------------------------------------- |
| Detection    | CI failure, QA test, or user feedback |
| Logging      | GitHub issue â†’ label `bug` + priority |
| Triage       | PO + Lead Dev assign S1â€“S4            |
| Fix          | Feature branch â†’ PR â†’ CI must pass    |
| Verification | QA closes after regression test       |
| Metrics      | MTTR < 2 days for S1/S2               |

### 18 Severity & Priority Matrix

| Severity          | Description                        | Target Fix Time | Responsible |
| ----------------- | ---------------------------------- | --------------- | ----------- |
| **S1 â€“ Critical** | Production outage / data loss      | â‰¤ 24 h          | DevOps + QA |
| **S2 â€“ Major**    | Feature blocked, workaround exists | â‰¤ 3 d           | Dev Lead    |
| **S3 â€“ Minor**    | Cosmetic / low impact              | â‰¤ 7 d           | Dev         |
| **S4 â€“ Trivial**  | Typos / docs                       | Next sprint     | Dev         |

---

## 19 Continuous Improvement Process

- Weekly QA sync for flaky/failing tests
- Monthly coverage trend chart (Grafana)
- Quarterly post-mortem for escaped defects
- Add new tests for each production incident

---

## 20 Glossary

**AC** â€“ Acceptance Criteriaâ€ƒ
**ADR** â€“ Architecture Decision Record  
**CI/CD** â€“ Continuous Integration / Deploymentâ€ƒ
**DSR** â€“ Data Subject Rights  
**E2E** â€“ End-to-End Testingâ€ƒ
**FR/NFR** â€“ Functional / Non-Functional Requirement  
**LCP** â€“ Largest Contentful Paintâ€ƒ
**MTTR** â€“ Mean Time to Repair  
**PII** â€“ Personally Identifiable Informationâ€ƒ
**RTM** â€“ Requirements Traceability Matrix  
**SLO** â€“ Service Level Objectiveâ€ƒ
**WCAG** â€“ Web Content Accessibility Guidelines

---

> **Repository Location:** `apps/docs/FitVibe_QA_Plan.md`  
> All changes to this document must undergo the same review and CI policy as source code.

---

## Appendix A â€“ Risk-Based Testing Matrix

| Risk Area                | Likelihood | Impact | Risk Level  | Mitigation / Test Focus      |
| ------------------------ | ---------- | ------ | ----------- | ---------------------------- |
| Auth & Token Rotation    | High       | High   | ðŸ”´ Critical | Full regression each release |
| Session Completion Logic | Medium     | High   | ðŸŸ  Major    | Integration + Perf test      |
| Translation Service (AI) | Medium     | Medium | ðŸŸ¡ Moderate | Mock API, cache validation   |
| Feed Privacy             | Low        | High   | ðŸŸ¡ Moderate | Security + E2E clone tests   |
| Analytics Charts         | Low        | Medium | ðŸŸ¢ Minor    | Snapshot validation          |

