%% Source: PRD | Section: 7.1 | Heading: 7.1 ERD
erDiagram
    %% ==============================
    %% USERS & SECURITY
    %% ==============================
    USERS {
        uuid id
        string username
        string password_hash
        string role
        string status
        string preferred_lanf
        timestamp created_at
    }

    ROLES {
        string code
        string description
    }

    USER_CONTACTS {
        uuid id
        uuid user_id
        string type
        string value
        boolean is_primary
        boolean is_recovery
        boolean is_verified
        timestamp created_at
    }

    USER_STATIC {
        uuid user_id
        date date_of_birth
        string gender
    }

    GENDERS {
        string code
        string description
    }

    USER_STATE_HISTORY {
        uuid id
        uuid user_id
        decimal weight
        string unit
        string fitness_level
        string training_frequency
        string photo_url
        timestamp recorded_at
    }

    FITNESS_LEVELS {
        string code
        string description
    }

    AUTH_SESSIONS {
        uuid jti
        uuid user_id
        timestamp expires_at
        timestamp created_at
    }

    TRANSLATION_CACHE {
      uuid id
      string source
      string lang
      string translated
      timestamp created_at
    }

    %% ==============================
    %% EXERCISES & SESSIONS
    %% ==============================
    EXERCISES {
        uuid id
        uuid owner
        string name
        string type
        string muscle_group
        string[] tags
        boolean is_public
        string description_en
        string description_de
        timestamp created_at
        timestamp archived_at
    }

    EXERCISE_TYPES {
        string code
        string description
    }

    SESSIONS {
        uuid id
        uuid owner
        string title
        timestamp planned_for
        string recurrence_rule
        timestamp completed_at
        string status
        string visibility
        integer calories
        integer points
        timestamp created_at
        timestamp archived_at
    }

    SESSION_EXERCISES {
        uuid id
        uuid session_id
        uuid exercise_id
        int position
        string notes
    }

    PLANNED_EXERCISE_ATTRIBUTES {
        uuid id
        uuid session_exercise_id
        int sets
        int reps
        decimal load
        decimal distance
        interval duration
        int rpe
    }

    ACTUAL_EXERCISE_ATTRIBUTES {
        uuid id
        uuid session_exercise_id
        int sets
        int reps
        decimal load
        decimal distance
        interval duration
        int rpe
    }

    %% ==============================
    %% GAMIFICATION & COMMUNITY
    %% ==============================
    USER_POINTS {
        uuid id
        uuid user_id
        string source_type
        string algorithm_version
        int points
        timestamp awarded_at
    }

    BADGES {
        uuid id
        uuid user_id
        string badge_type
        timestamp awarded_at
    }

    FOLLOWERS {
        uuid id
        uuid follower_id
        uuid following_id
        timestamp created_at
    }

    MEDIA {
        uuid id
        uuid owner_id
        string target_type
        uuid target_id
        string file_url
        string media_type
        timestamp created_at
    }

    %% ==============================
    %% RELATIONSHIPS
    %% ==============================
    USERS ||--o{ USER_CONTACTS : has
    USERS ||--o{ USER_STATIC : has
    USERS ||--o{ USER_STATE_HISTORY : tracks
    USERS ||--o{ AUTH_SESSIONS : maintains
    USERS ||--o{ EXERCISES : owns
    USERS ||--o{ SESSIONS : plans
    USERS ||--o{ USER_POINTS : earns
    USERS ||--o{ BADGES : awarded
    USERS ||--o{ FOLLOWERS : connects

    USERS }o--|| ROLES : "has role"
    USER_STATIC }o--|| GENDERS : "has gender"
    USER_STATE_HISTORY }o--|| FITNESS_LEVELS : "has fitness level"
    EXERCISES }o--|| EXERCISE_TYPES : "has type"

    SESSIONS ||--o{ SESSION_EXERCISES : includes
    SESSION_EXERCISES ||--o{ PLANNED_EXERCISE_ATTRIBUTES : planned
    SESSION_EXERCISES ||--o{ ACTUAL_EXERCISE_ATTRIBUTES : actual
