# FitVibe — AC Master

_Date: 2025-10-26_

| Type   | Requirement ID   | Requirement Title                       | AC ID        | Acceptance Criteria (SMART)                                                                                                             | Test Method               | Evidence                                   | Owner   | Priority   | Gate   | Status   | Trace → PRD       | Trace → TDD                   |
|:-------|:-----------------|:----------------------------------------|:-------------|:----------------------------------------------------------------------------------------------------------------------------------------|:--------------------------|:-------------------------------------------|:--------|:-----------|:-------|:---------|:------------------|:------------------------------|
| FR     | FR-001           | User Registration                       | FR-001-AC01  | Given a valid email+password, when the user submits /auth/register, then an account is created in <1s and a verification email is sent. | API integration test      | HTTP recordings + DB snapshot before/after | ENG/QA  | High       | GOLD   | Proposed | PRD §Auth         | TDD §Auth-API                 |
| FR     | FR-001           | User Registration                       | FR-001-AC02  | Unverified users cannot access protected routes; attempts return 401/redirect until email verification completes.                       | E2E flow (UI)             | HTTP recordings + DB snapshot before/after | ENG/QA  | High       | GOLD   | Proposed | PRD §Auth         | TDD §Auth-API                 |
| FR     | FR-001           | User Registration                       | FR-001-AC03  | Duplicate registrations for the same email are rejected with a clear error; no duplicate user records are created.                      | API negative test         | HTTP recordings + DB snapshot before/after | ENG/QA  | High       | GOLD   | Proposed | PRD §Auth         | TDD §Auth-API                 |
| FR     | FR-002           | Login & Session                         | FR-002-AC01  | Successful login issues an RS256-signed access token (≤15 min TTL) and a refresh token; both stored per security guidelines.            | API + unit tokens         | JWT sample + revocation log                | ENG/QA  | High       | GOLD   | Proposed | PRD §Auth         | TDD §Sessions                 |
| FR     | FR-002           | Login & Session                         | FR-002-AC02  | Logout invalidates refresh token server-side; subsequent refresh attempts fail (401) within 1s.                                         | Integration (revocation)  | JWT sample + revocation log                | ENG/QA  | High       | GOLD   | Proposed | PRD §Auth         | TDD §Sessions                 |
| FR     | FR-002           | Login & Session                         | FR-002-AC03  | Incorrect credentials lead to a single generalized error message without leaking which field was wrong.                                 | Security negative test    | JWT sample + revocation log                | ENG/QA  | High       | GOLD   | Proposed | PRD §Auth         | TDD §Sessions                 |
| FR     | FR-003           | Pre‑Login Access Restricted (Auth‑Wall) | FR-003-AC01  | Unauthenticated navigation to any SPA route except /login and /register results in redirect to /login.                                  | E2E (Playwright)          | Screenshots, 401/404 traces                | ENG/QA  | High       | GOLD   | Proposed | PRD §Privacy      | ADR‑0012; TDD §Middleware     |
| FR     | FR-003           | Pre‑Login Access Restricted (Auth‑Wall) | FR-003-AC02  | Unauthenticated API calls to /api/** return 401 with body { error: "unauthorized" }.                                                    | API integration           | Screenshots, 401/404 traces                | ENG/QA  | High       | GOLD   | Proposed | PRD §Privacy      | ADR‑0012; TDD §Middleware     |
| FR     | FR-003           | Pre‑Login Access Restricted (Auth‑Wall) | FR-003-AC03  | Legacy public/share links return 404; static assets required for auth pages remain reachable (200).                                     | Static asset/negative E2E | Screenshots, 401/404 traces                | ENG/QA  | High       | GOLD   | Proposed | PRD §Privacy      | ADR‑0012; TDD §Middleware     |
| FR     | FR-004           | Training Plan Management                | FR-004-AC01  | Users can create/edit/delete plans; operations persist within 500 ms and are visible after reload.                                      | Integration tests         | DB diff + UI screenshots                   | ENG     | Medium     | SILVER | Proposed | PRD §Planner      | TDD §Planner Module           |
| FR     | FR-004           | Training Plan Management                | FR-004-AC02  | Drag‑and‑drop scheduling updates the plan and re-renders the calendar without full page reload.                                         | E2E drag/drop             | DB diff + UI screenshots                   | ENG     | Medium     | SILVER | Proposed | PRD §Planner      | TDD §Planner Module           |
| FR     | FR-004           | Training Plan Management                | FR-004-AC03  | Conflicts (overlapping sessions) are detected and surfaced with actionable messages before save.                                        | Rule engine unit + E2E    | DB diff + UI screenshots                   | ENG     | Medium     | SILVER | Proposed | PRD §Planner      | TDD §Planner Module           |
| FR     | FR-005           | Workout Logging & Import                | FR-005-AC01  | Start/stop a session records duration, distance, and HR; edits audit‑logged with user/time.                                             | Unit parsers              | Sample files + audit log excerpt           | ENG     | Medium     | SILVER | Proposed | PRD §Logging      | TDD §Importers                |
| FR     | FR-005           | Workout Logging & Import                | FR-005-AC02  | Importing a supported file (e.g., GPX/FIT) parses ≥99% of valid samples and rejects malformed inputs gracefully.                        | Fuzz/fixture import       | Sample files + audit log excerpt           | ENG     | Medium     | SILVER | Proposed | PRD §Logging      | TDD §Importers                |
| FR     | FR-005           | Workout Logging & Import                | FR-005-AC03  | Editing key metrics (pace, elevation) recomputes derived metrics consistently within 200 ms.                                            | Integration calc tests    | Sample files + audit log excerpt           | ENG     | Medium     | SILVER | Proposed | PRD §Logging      | TDD §Importers                |
| FR     | FR-006           | Badges & Points                         | FR-006-AC01  | Earning conditions compute deterministically for the same inputs (idempotent scoring).                                                  | Property-based tests      | Before/after user states                   | ENG     | Medium     | SILVER | Proposed | PRD §Gamification | TDD §Rules Engine             |
| FR     | FR-006           | Badges & Points                         | FR-006-AC02  | Badge awards appear in profile within 2s of qualifying event and persist across reload.                                                 | E2E UI check              | Before/after user states                   | ENG     | Medium     | SILVER | Proposed | PRD §Gamification | TDD §Rules Engine             |
| FR     | FR-006           | Badges & Points                         | FR-006-AC03  | Revoking/adjusting rules re-evaluates affected users and updates badges within one job cycle.                                           | Batch job integration     | Before/after user states                   | ENG     | Medium     | SILVER | Proposed | PRD §Gamification | TDD §Rules Engine             |
| NFR    | NFR-001          | Security Hardening                      | NFR-001-AC01 | CSP enforced with no inline scripts/styles; report-only passes for 7 days before enforce with ≤1% violations.                           | ZAP + header checks       | Header dump + ZAP report                   | SEC/ENG | High       | GOLD   | Proposed | PRD §Security     | TDD §Security; ADRs           |
| NFR    | NFR-001          | Security Hardening                      | NFR-001-AC02 | Rate limit on /auth endpoints: ≥10 req/min/IP with proper 429 responses and Retry-After headers.                                        | Rate-limit integration    | Header dump + ZAP report                   | SEC/ENG | High       | GOLD   | Proposed | PRD §Security     | TDD §Security; ADRs           |
| NFR    | NFR-001          | Security Hardening                      | NFR-001-AC03 | Tokens: RS256, proper audience/issuer, clock skew ≤30s; refresh rotation with replay detection.                                         | Unit + integration JWT    | Header dump + ZAP report                   | SEC/ENG | High       | GOLD   | Proposed | PRD §Security     | TDD §Security; ADRs           |
| NFR    | NFR-002          | Privacy / DSGVO                         | NFR-002-AC01 | Data minimization: no sensitive PII in logs; redaction verified in tests across error paths.                                            | Unit redaction            | Log samples + job runbook                  | ENG/QA  | High       | GOLD   | Proposed | PRD §Privacy      | TDD §Data; QA Plan            |
| NFR    | NFR-002          | Privacy / DSGVO                         | NFR-002-AC02 | User data export and deletion flows documented and tested with synthetic users.                                                         | E2E DSR dry-run           | Log samples + job runbook                  | ENG/QA  | High       | GOLD   | Proposed | PRD §Privacy      | TDD §Data; QA Plan            |
| NFR    | NFR-002          | Privacy / DSGVO                         | NFR-002-AC03 | Retention: automatic purge jobs execute per policy; evidence of at least one successful run in staging.                                 | Ops log review            | Log samples + job runbook                  | ENG/QA  | High       | GOLD   | Proposed | PRD §Privacy      | TDD §Data; QA Plan            |
| NFR    | NFR-003          | Performance (Web)                       | NFR-003-AC01 | P95 LCP ≤ 2.5 s and CLS ≤ 0.1 on Dashboard and Planner pages in staging and prod.                                                       | LHCI CI budgets           | LHCI reports + WebPageTest                 | ENG     | High       | GOLD   | Proposed | PRD §Performance  | TDD §Perf                     |
| NFR    | NFR-003          | Performance (Web)                       | NFR-003-AC02 | P95 TTFB ≤ 500 ms for authenticated HTML/API responses.                                                                                 | Synthetic tests           | LHCI reports + WebPageTest                 | ENG     | High       | GOLD   | Proposed | PRD §Performance  | TDD §Perf                     |
| NFR    | NFR-003          | Performance (Web)                       | NFR-003-AC03 | No regression >10% on Core Web Vitals across releases (checked by LHCI budget).                                                         | Trend comparison          | LHCI reports + WebPageTest                 | ENG     | High       | GOLD   | Proposed | PRD §Performance  | TDD §Perf                     |
| NFR    | NFR-004          | Accessibility (WCAG 2.1 AA)             | NFR-004-AC01 | Color contrast ≥ 4.5:1 for text elements; automated axe checks pass with 0 critical issues.                                             | axe CI + Storybook        | axe JSON + screenshots                     | ENG/QA  | High       | GOLD   | Proposed | PRD §A11y         | Visual Design System; QA Plan |
| NFR    | NFR-004          | Accessibility (WCAG 2.1 AA)             | NFR-004-AC02 | All interactive elements reachable by keyboard; visible focus states on all components.                                                 | Manual keyboard sweeps    | axe JSON + screenshots                     | ENG/QA  | High       | GOLD   | Proposed | PRD §A11y         | Visual Design System; QA Plan |
| NFR    | NFR-004          | Accessibility (WCAG 2.1 AA)             | NFR-004-AC03 | Screen-reader labels/roles present for forms and navigation; no empty links/buttons.                                                    | SR spot checks            | axe JSON + screenshots                     | ENG/QA  | High       | GOLD   | Proposed | PRD §A11y         | Visual Design System; QA Plan |
| NFR    | NFR-005          | Availability & Backups                  | NFR-005-AC01 | SLO uptime ≥ 99.0% monthly; outages recorded with RCA within 5 business days.                                                           | Monitoring review         | Status page + restore logs                 | OPS/ENG | High       | SILVER | Proposed | PRD §Ops          | TDD §Ops; QA Plan             |
| NFR    | NFR-005          | Availability & Backups                  | NFR-005-AC02 | Nightly backups complete successfully; monthly restore drill validates RTO/RPO targets.                                                 | Restore drill             | Status page + restore logs                 | OPS/ENG | High       | SILVER | Proposed | PRD §Ops          | TDD §Ops; QA Plan             |
| NFR    | NFR-005          | Availability & Backups                  | NFR-005-AC03 | /healthz reachable only from allowlisted IPs; returns no sensitive data.                                                                | Network/proxy test        | Status page + restore logs                 | OPS/ENG | High       | SILVER | Proposed | PRD §Ops          | TDD §Ops; QA Plan             |
| NFR    | NFR-006          | Internationalization                    | NFR-006-AC01 | Static keys exist for EN and DE; missing‑key linter passes CI with 0 missing keys.                                                      | Lint + snapshot           | Lint logs + snapshots                      | ENG     | Medium     | SILVER | Proposed | PRD §i18n         | TDD §i18n                     |
| NFR    | NFR-006          | Internationalization                    | NFR-006-AC02 | Language toggle persists across sessions; locale formats (date, number) match selection.                                                | E2E toggle                | Lint logs + snapshots                      | ENG     | Medium     | SILVER | Proposed | PRD §i18n         | TDD §i18n                     |
| NFR    | NFR-006          | Internationalization                    | NFR-006-AC03 | No hard-coded user-facing strings in code paths covered by tests.                                                                       | Static analysis           | Lint logs + snapshots                      | ENG     | Medium     | SILVER | Proposed | PRD §i18n         | TDD §i18n                     |